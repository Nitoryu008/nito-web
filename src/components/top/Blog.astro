---
import { getCollection } from "astro:content";
import { container, vstack } from "../../../styled-system/patterns";
import BlogItem from "../BlogItem.astro";
import TopSection from "./TopSection.astro";

const blog = await getCollection("blog");

const section = container({
  paddingInline: "px.container",
  paddingBlock: "py.section",
  maxWidth: "max.width.container",
  overflowX: "hidden",
});
---

<TopSection heading="BLOG" href="/blog" class={section}>
  <ul class={vstack({ gap: "10", "& li": { width: "100%" } })}>
    {
      blog.map((item) => (
        <li class="blog_item">
          <a href={`/blog/${item.slug}`}>
            <BlogItem date={item.data.pubDate}>{item.data.title}</BlogItem>
          </a>
        </li>
      ))
    }
  </ul>
</TopSection>

<script>
  import { gsap } from "gsap";
  import ScrollTrigger from "gsap/ScrollTrigger";
  gsap.registerPlugin(ScrollTrigger);

  gsap.from(".blog_item", {
    x: "10%",
    opacity: "0",
    ease: "expo.out",
    scrollTrigger: {
      trigger: ".blog_item",
      start: "center bottom-=200",
    },
    stagger: {
      from: "start",
      amount: 0.5,
    },
  });
</script>
